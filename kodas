#include <iomanip>
#include <iostream>
#include <vector>
#include <cmath>
#include <algorithm>

using std::cout;
using std::endl;
using std::left;
using std::right;
using std::string;
using std::vector;
using std::cin;
using std::setw;
using std::setprecision;
using std::fixed;
using std::sort;

struct Studentas
{
    string var;
    string pav;
    vector <int> paz;
    int egz;
    float gal;
    float med;
};

double Mediana(const Studentas& s){
    vector <int> visi;
    visi = s.paz;
    visi.push_back(s.egz);
    sort(visi.begin(), visi.end());
    if(visi.size() % 2 != 0){
        return visi[visi.size()/2];
    }
    else{
        return (float(visi[visi.size()/2]) + visi[(visi.size()/2) - 1]) / 2;
    }
}

Studentas Stud_iv()
{
    int m, laik_paz, suma = 0;
    Studentas Pirmas;
    cout << "Ivesti studento duomenis " << endl;
    cout << "Vardas: "; cin >> Pirmas.var;
    cout << "Pavarde: "; cin >> Pirmas.pav;
    cout << "Kiek pazymiu turi " << Pirmas.var << " " << Pirmas.pav << ": "; cin >> m;
    for (int n = 1; n <= m; n++)
    {
        bool tinkamas = false;
        while(!tinkamas) {
            cout << "Iveskite " << n << " pazymi:"; 
            cin >> laik_paz;

            if(cin.fail()) { //naudojamas patikrinti ar inputas teisingas
                cin.clear();
                cin.ignore(1000, '\n');
                cout << "Ivedete ne skaiciu. Iveskite skaiciu." << endl; 
                continue;
            }

            if(laik_paz > 0 && laik_paz <= 10){
                tinkamas = true;
            }
            else {
            cout << "Ivedete netinkama pazymi. Pabandykite dar karta." << endl; 
            }
        }   
        Pirmas.paz.push_back(laik_paz);
        suma += laik_paz;
}
    cout << "Koks egzamino razultatas :"; cin >> Pirmas.egz;
    Pirmas.gal = double(suma) / double(m) * 0.4 + 0.6 * Pirmas.egz;
    Pirmas.med = Mediana(Pirmas);

    return Pirmas;
}

int main()
{
    vector<Studentas> Grupe;
    cout << "Kiek studentu yra grupeje? ";
    int n;
    cin >> n;
    Studentas past;
    for(auto z = 0; z < n; z++)
    {
        Grupe.push_back(Stud_iv());
    }
    

    cout << setw(15) << left << "Pavarde " << setw(10) << left << "Vardas " << setw(15) << left << "Galutinis (Vid.)" << endl;
    cout << "-------------------------------------------" <<endl;
    for(auto& past : Grupe)
    {   
        cout << setw(15) << left << past.pav << " | " << setw(10) << left << past.var << " | " ;
        cout << setw(10) << fixed << setprecision(2) << past.gal << " | " << past.med << endl;
    }
}
